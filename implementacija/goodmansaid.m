function [B1,B2,B3] = goodmansaid(T,F,dF)    
    x1 = T(1,1); y1 = T(1,2);
    x2 = T(2,1); y2 = T(2,2);
    x3 = T(3,1); y3 = T(3,2);
        
    Fx1 = dF(1,1); Fy1 = dF(1,2);
    Fe21 = (x1 - x3) * Fx1 + (y1 - y3) * Fy1;
    Fe31 = (x2 - x1) * Fx1 + (y2 - y1) * Fy1;
        
    Fx2 = dF(2,1); Fy2 = dF(2,2);
    Fe12 = (x3 - x2) * Fx2 + (y3 - y2) * Fy2;
    Fe32 = (x2 - x1) * Fx2 + (y2 - y1) * Fy2;
        
    Fx3 = dF(3,1); Fy3 = dF(3,2);
    Fe13 = (x3 - x2) * Fx3 + (y3 - y2) * Fy3;
    Fe23 = (x1 - x3) * Fx3 + (y1 - y3) * Fy3;
        
    b300 = F(1);
    b210 = F(1) + Fe31 / 3;
    b201 = F(1) - Fe21 / 3;
        
    b030 = F(2);
    b021 = F(2) + Fe12 / 3;
    b120 = F(2) - Fe32 / 3;
        
    b003 = F(3);
    b102 = F(3) + Fe23 / 3;
    b012 = F(3) - Fe13 / 3;
        
    h1 = -(x3*x1 + y3*y1) / (x1^2 + y1^2);
    b111 = (b120 + b102 + h1 * (2 * b012 - b021 - b003)) / 2 + ...
         (1 - h1) * (2 * b021 - b030 - b012);
        
    h2 = -(x1*x2 + y1*y2) / (x2^2 + y2^2);
    b112 = (b012 + b210 + h2 * (2 * b201 - b102 - b300)) / 2 + ...
          (1 - h2) * (2 * b102 - b003 - b201);
        
    h3 = -(x2*x3 + y2*y3) / (x3^2 + y3^2);
    b113 = (b201 + b021 + h3 * (2 * b120 - b210 - b030)) / 2 + ...
          (1 - h3) * (2 * b210 - b300 - b120);
        
    BT = [
        b300 b210 b120 b030; ...
        b201 nan b021 nan; ...
        b102 b012 nan nan; ...
        b003 nan nan nan; ...
    ];
        
    BT(2,2) = b111;
    B1 = BT;
    BT(2,2) = b112;
    B2 = BT;
    BT(2,2) = b113;
    B3 = BT;
end