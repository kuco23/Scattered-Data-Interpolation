function B = goodmansaid(T,F,dF)    
    V1 = T(1,:); V2 = T(2,:); V3 = T(3,:);
    e1 = V3 - V2; e2 = V1 - V3; e3 = V2 - V1;
    x1 = V1(1); y1 = V1(2);
    x2 = V2(1); y2 = V2(2);
    x3 = V3(1); y3 = V3(2);
        
    Fx1 = dF(1,1); Fy1 = dF(1,2);
    Fe21 = (x1 - x3) * Fx1 + (y1 - y3) * Fy1;
    Fe31 = (x2 - x1) * Fx1 + (y2 - y1) * Fy1;
        
    Fx2 = dF(2,1); Fy2 = dF(2,2);
    Fe12 = (x3 - x2) * Fx2 + (y3 - y2) * Fy2;
    Fe32 = (x2 - x1) * Fx2 + (y2 - y1) * Fy2;
        
    Fx3 = dF(3,1); Fy3 = dF(3,2);
    Fe13 = (x3 - x2) * Fx3 + (y3 - y2) * Fy3;
    Fe23 = (x1 - x3) * Fx3 + (y1 - y3) * Fy3;
        
    b300 = F(1);
    b210 = F(1) + Fe31 / 3;
    b201 = F(1) - Fe21 / 3;
        
    b030 = F(2);
    b021 = F(2) + Fe12 / 3;
    b120 = F(2) - Fe32 / 3;
        
    b003 = F(3);
    b102 = F(3) + Fe23 / 3;
    b012 = F(3) - Fe13 / 3;
    
    h1 = -(e3*e1') / norm(e1)^2;
    b1111 = (b120 + b102 + h1 * (2 * b012 - b021 - b003)) / 2 + ...
         (1 - h1) * (2 * b021 - b030 - b012);
    
    h2 = -(e1*e2') / norm(e2)^2;
    b1112 = (b012 + b210 + h2 * (2 * b201 - b102 - b300)) / 2 + ...
          (1 - h2) * (2 * b102 - b003 - b201);
        
    h3 = -(e2*e3') / norm(e3)^2;
    b1113 = (b201 + b021 + h3 * (2 * b120 - b210 - b030)) / 2 + ...
          (1 - h3) * (2 * b210 - b300 - b120);
        
    B = [
        b300 b210 b120 b030; ...
        b201 nan b021 nan; ...
        b102 b012 nan b1112; ...
        b003 nan b1113 b1111; ...
    ];
end